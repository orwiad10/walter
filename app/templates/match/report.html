{% extends 'base.html' %}
{% block content %}
<p><a href="{{ url_for('view_tournament', tid=m.round.tournament_id) }}">Back to Tournament</a></p>
<h2>Report Match</h2>
<p>Round {{ m.round.number }} — Table {{ m.table_number }}</p>
<p>
  {% if m.player2_id %}
    {{ m.player1.user.name }} vs {{ m.player2.user.name }}
  {% else %}
    {{ m.player1.user.name }} has a BYE
  {% endif %}
</p>
{% if t.format == 'Commander' %}
<form method="post">
  <label>{{ m.player1.user.name }} place: <input type="number" name="p1_place" min="1" max="4"></label><br>
  {% if m.player2_id %}<label>{{ m.player2.user.name }} place: <input type="number" name="p2_place" min="1" max="4"></label><br>{% endif %}
  {% if m.player3_id %}<label>{{ m.player3.user.name }} place: <input type="number" name="p3_place" min="1" max="4"></label><br>{% endif %}
  {% if m.player4_id %}<label>{{ m.player4.user.name }} place: <input type="number" name="p4_place" min="1" max="4"></label><br>{% endif %}
  <label><input type="checkbox" name="is_draw"> Draw (all players)</label><br>
  <button class="btn" type="submit">Submit Result</button>
</form>
{% else %}
  {% if m.player2_id %}
  <form method="post">
    <label>{{ m.player1.user.name }} game wins: <input type="number" name="p1_wins" min="0" required></label><br>
    <label>{{ m.player2.user.name }} game wins: <input type="number" name="p2_wins" min="0" required></label><br>
    <label>Draws: <input type="number" name="draws" min="0" value="0"></label><br>
    <label><input type="checkbox" name="drop_p1"> Drop {{ m.player1.user.name }}</label><br>
    <label><input type="checkbox" name="drop_p2"> Drop {{ m.player2.user.name }}</label><br>
    <button class="btn" type="submit">Submit Result</button>
  </form>
  {% else %}
  <p>BYE — no reporting needed.</p>
  {% endif %}
{% endif %}
{% endblock %}
